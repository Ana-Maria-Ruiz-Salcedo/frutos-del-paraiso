<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contabilidad - Frutos del Para√≠so</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #f7b2d9, #ffe3ec);
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    
    h1 { 
      text-align: center; 
      color: #e6659f; 
      margin: 20px 0;
      font-size: 24px;
      padding: 0 15px;
    }
    
    .container { 
      width: 95%; 
      max-width: 1200px;
      margin: 0 auto 20px; 
      padding: 0 10px;
    }

    /* Botones de navegaci√≥n */
    .nav-buttons { 
      display: flex; 
      justify-content: center; 
      gap: 10px; 
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .nav-buttons button { 
      background-color: #f48fb1; 
      color: white; 
      padding: 10px 20px; 
      border-radius: 8px; 
      border: none; 
      cursor: pointer; 
      font-weight: bold;
      font-size: 14px;
      transition: 0.3s;
    }
    .nav-buttons button:hover { background-color: #e6659f; }

    /* Tabs */
    .tabs { 
      display: flex; 
      justify-content: flex-start;
      gap: 8px; 
      margin-bottom: 15px;
      overflow-x: auto;
      padding-bottom: 10px;
      -webkit-overflow-scrolling: touch;
    }
    .tabs::-webkit-scrollbar { height: 6px; }
    .tabs::-webkit-scrollbar-thumb { background: #f48fb1; border-radius: 3px; }
    
    .tab { 
      padding: 10px 18px; 
      cursor: pointer; 
      background: #f48fb1; 
      border-radius: 8px; 
      color: white; 
      font-weight: bold;
      white-space: nowrap;
      font-size: 14px;
      transition: 0.3s;
      flex-shrink: 0;
    }
    .tab.active { background: #e6659f; }
    .tab:hover { background: #e6659f; }

    /* Bot√≥n exportar */
    .export-btn { 
      background-color: #36a2f7; 
      margin-bottom: 15px;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    .export-btn:hover { background-color: #2b83c3; }

    /* Secciones */
    .section { 
      display: none; 
      background: white; 
      padding: 20px; 
      border-radius: 15px; 
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .section.active { display: block; }

    h2 { 
      color: #e6659f; 
      margin-bottom: 15px;
      font-size: 20px;
    }
    
    h3 { 
      color: #e6659f; 
      margin: 20px 0 10px;
      font-size: 18px;
    }

    /* Formularios */
    input, select { 
      padding: 12px; 
      margin: 8px 0; 
      width: 100%; 
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      font-family: 'Poppins', sans-serif;
    }

    button:not(.tab):not(.nav-buttons button):not(.export-btn) { 
      padding: 12px 20px; 
      margin-top: 10px; 
      background: #e6659f; 
      border: none; 
      color: white; 
      cursor: pointer; 
      border-radius: 8px;
      width: 100%;
      font-size: 16px;
      font-weight: bold;
      transition: 0.3s;
    }
    button:not(.tab):not(.nav-buttons button):not(.export-btn):hover { 
      background: #d9578f; 
    }

    /* Tablas */
    .tabla-wrapper {
      overflow-x: auto;
      margin-top: 15px;
      -webkit-overflow-scrolling: touch;
      border-radius: 10px;
    }
    
    table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-bottom: 20px;
      min-width: 500px;
    }
    
    th, td { 
      border: 1px solid #ddd; 
      padding: 12px 10px; 
      text-align: left;
      font-size: 14px;
    }
    
    th { 
      background: #f48fb1; 
      color: white;
      font-weight: bold;
      position: sticky;
      top: 0;
    }

    td { background: white; }

    /* Resumen financiero */
    .resumen-cards {
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }

    .card-resumen {
      background: linear-gradient(135deg, #f48fb1, #e6659f);
      color: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .card-resumen h4 {
      margin: 0 0 10px;
      font-size: 14px;
      opacity: 0.9;
    }

    .card-resumen p {
      margin: 0;
      font-size: 28px;
      font-weight: bold;
    }

    .card-balance {
      background: linear-gradient(135deg, #34eb7a, #28c96a);
    }

    canvas { 
      max-width: 100%;
      margin-top: 20px;
    }

    /* Tablet */
    @media (min-width: 481px) and (max-width: 768px) {
      .resumen-cards {
        grid-template-columns: repeat(2, 1fr);
      }

      h1 { font-size: 26px; }
      
      .tab { padding: 10px 20px; }
    }

    /* Desktop */
    @media (min-width: 769px) {
      h1 { font-size: 32px; }

      .container { width: 90%; }

      .resumen-cards {
        grid-template-columns: repeat(3, 1fr);
      }

      .tabs { 
        justify-content: center;
        overflow-x: visible;
      }

      .export-btn {
        width: auto;
        padding: 12px 30px;
      }

      button:not(.tab):not(.nav-buttons button):not(.export-btn) {
        width: auto;
      }

      table { min-width: auto; }
    }

    /* Mobile peque√±o */
    @media (max-width: 480px) {
      h1 { font-size: 20px; }
      h2 { font-size: 18px; }
      h3 { font-size: 16px; }

      .section { padding: 15px; }
      
      .nav-buttons button {
        padding: 8px 15px;
        font-size: 13px;
      }

      .tab {
        padding: 8px 15px;
        font-size: 13px;
      }

      th, td {
        padding: 10px 8px;
        font-size: 13px;
      }

      .card-resumen p {
        font-size: 24px;
      }
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
  <h1>üí∞ Contabilidad - Panel Administrador</h1>
  <div class="container">

    <!-- Botones de navegaci√≥n -->
    <div class="nav-buttons">
      <button onclick="window.location.href='index.html'">üè† Inicio</button>
      <button onclick="window.location.href='admin.html'">üîô Administrador</button>
    </div>

    <div class="tabs">
      <div class="tab active" data-tab="proveedores">Proveedores</div>
      <div class="tab" data-tab="gastos">Gastos</div>
      <div class="tab" data-tab="ingresos">Ingresos</div>
      <div class="tab" data-tab="resumen">Resumen</div>
    </div>

    <button class="export-btn" onclick="exportExcel()">üìä Exportar a Excel</button>

    <!-- Secci√≥n Proveedores -->
    <div class="section active" id="proveedores">
      <h2>Registrar Proveedor</h2>
      <input type="text" id="provNombre" placeholder="Nombre del proveedor">
      <input type="text" id="provContacto" placeholder="Tel√©fono o email">
      <input type="text" id="provProductos" placeholder="Productos o servicios">
      <button onclick="agregarProveedor()">‚ûï Agregar Proveedor</button>
      
      <h3>Lista de Proveedores</h3>
      <div class="tabla-wrapper">
        <table id="tablaProveedores">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Contacto</th>
              <th>Productos/Servicios</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Secci√≥n Gastos -->
    <div class="section" id="gastos">
      <h2>Registrar Gasto</h2>
      <input type="date" id="gastoFecha">
      <input type="text" id="gastoConcepto" placeholder="Concepto del gasto">
      <input type="number" id="gastoMonto" placeholder="Monto">
      <select id="gastoCategoria">
        <option value="Ingredientes">Ingredientes</option>
        <option value="Servicios">Servicios</option>
        <option value="Transporte">Transporte</option>
        <option value="Otros">Otros</option>
      </select>
      <button onclick="agregarGasto()">‚ûï Agregar Gasto</button>
      
      <h3>Lista de Gastos</h3>
      <div class="tabla-wrapper">
        <table id="tablaGastos">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Concepto</th>
              <th>Monto</th>
              <th>Categor√≠a</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Secci√≥n Ingresos -->
    <div class="section" id="ingresos">
      <h2>Registrar Ingreso</h2>
      <input type="date" id="ingresoFecha">
      <input type="text" id="ingresoConcepto" placeholder="Concepto del ingreso">
      <input type="number" id="ingresoMonto" placeholder="Monto">
      <select id="ingresoMetodo">
        <option value="Nequi">Nequi</option>
        <option value="Daviplata">Daviplata</option>
        <option value="Contraentrega">Contraentrega</option>
      </select>
      <button onclick="agregarIngreso()">‚ûï Agregar Ingreso</button>
      
      <h3>Lista de Ingresos</h3>
      <div class="tabla-wrapper">
        <table id="tablaIngresos">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Concepto</th>
              <th>Monto</th>
              <th>M√©todo</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Secci√≥n Resumen -->
    <div class="section" id="resumen">
      <h2>üìà Resumen Financiero</h2>
      
      <div class="resumen-cards">
        <div class="card-resumen">
          <h4>Total Gastos</h4>
          <p id="totalGastos">$0</p>
        </div>
        <div class="card-resumen">
          <h4>Total Ingresos</h4>
          <p id="totalIngresos">$0</p>
        </div>
        <div class="card-resumen card-balance">
          <h4>Balance</h4>
          <p id="balance">$0</p>
        </div>
      </div>

      <canvas id="graficoResumen"></canvas>
    </div>
  </div>

  <script>
    // Manejo de pesta√±as
    const tabs = document.querySelectorAll('.tab');
    const sections = document.querySelectorAll('.section');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        sections.forEach(s => s.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // Datos
    let proveedores = JSON.parse(localStorage.getItem('proveedores')) || [];
    let gastos = JSON.parse(localStorage.getItem('gastos')) || [];
    let ingresos = JSON.parse(localStorage.getItem('ingresos')) || [];

    // Funciones Proveedores
    function agregarProveedor() {
      const nombre = document.getElementById('provNombre').value.trim();
      const contacto = document.getElementById('provContacto').value.trim();
      const productos = document.getElementById('provProductos').value.trim();
      
      if(nombre && contacto && productos) {
        proveedores.push({nombre, contacto, productos});
        localStorage.setItem('proveedores', JSON.stringify(proveedores));
        mostrarProveedores();
        document.getElementById('provNombre').value = '';
        document.getElementById('provContacto').value = '';
        document.getElementById('provProductos').value = '';
        alert('‚úÖ Proveedor agregado correctamente');
      } else {
        alert('‚ö†Ô∏è Por favor completa todos los campos');
      }
    }

    function mostrarProveedores() {
      const tbody = document.querySelector('#tablaProveedores tbody');
      tbody.innerHTML = '';
      proveedores.forEach(p => {
        const row = `<tr><td>${p.nombre}</td><td>${p.contacto}</td><td>${p.productos}</td></tr>`;
        tbody.innerHTML += row;
      });
    }

    // Funciones Gastos
    function agregarGasto() {
      const fecha = document.getElementById('gastoFecha').value;
      const concepto = document.getElementById('gastoConcepto').value.trim();
      const monto = parseFloat(document.getElementById('gastoMonto').value);
      const categoria = document.getElementById('gastoCategoria').value;
      
      if(fecha && concepto && monto) {
        gastos.push({fecha, concepto, monto, categoria});
        localStorage.setItem('gastos', JSON.stringify(gastos));
        mostrarGastos();
        actualizarResumen();
        document.getElementById('gastoFecha').value = '';
        document.getElementById('gastoConcepto').value = '';
        document.getElementById('gastoMonto').value = '';
        alert('‚úÖ Gasto registrado correctamente');
      } else {
        alert('‚ö†Ô∏è Por favor completa todos los campos');
      }
    }

    function mostrarGastos() {
      const tbody = document.querySelector('#tablaGastos tbody');
      tbody.innerHTML = '';
      gastos.forEach(g => {
        const row = `<tr><td>${g.fecha}</td><td>${g.concepto}</td><td>$${g.monto.toLocaleString('es-CO')}</td><td>${g.categoria}</td></tr>`;
        tbody.innerHTML += row;
      });
    }

    // Funciones Ingresos
    function agregarIngreso() {
      const fecha = document.getElementById('ingresoFecha').value;
      const concepto = document.getElementById('ingresoConcepto').value.trim();
      const monto = parseFloat(document.getElementById('ingresoMonto').value);
      const metodo = document.getElementById('ingresoMetodo').value;
      
      if(fecha && concepto && monto) {
        ingresos.push({fecha, concepto, monto, metodo});
        localStorage.setItem('ingresos', JSON.stringify(ingresos));
        mostrarIngresos();
        actualizarResumen();
        document.getElementById('ingresoFecha').value = '';
        document.getElementById('ingresoConcepto').value = '';
        document.getElementById('ingresoMonto').value = '';
        alert('‚úÖ Ingreso registrado correctamente');
      } else {
        alert('‚ö†Ô∏è Por favor completa todos los campos');
      }
    }

    function mostrarIngresos() {
      const tbody = document.querySelector('#tablaIngresos tbody');
      tbody.innerHTML = '';
      ingresos.forEach(i => {
        const row = `<tr><td>${i.fecha}</td><td>${i.concepto}</td><td>$${i.monto.toLocaleString('es-CO')}</td><td>${i.metodo}</td></tr>`;
        tbody.innerHTML += row;
      });
    }

    // Resumen y gr√°fico
    function actualizarResumen() {
      const totalGastos = gastos.reduce((sum, g) => sum + g.monto, 0);
      const totalIngresos = ingresos.reduce((sum, i) => sum + i.monto, 0);
      const balance = totalIngresos - totalGastos;

      document.getElementById('totalGastos').innerText = `$${totalGastos.toLocaleString('es-CO')}`;
      document.getElementById('totalIngresos').innerText = `$${totalIngresos.toLocaleString('es-CO')}`;
      document.getElementById('balance').innerText = `$${balance.toLocaleString('es-CO')}`;

      const ctx = document.getElementById('graficoResumen').getContext('2d');
      if(window.miGrafico) window.miGrafico.destroy();
      window.miGrafico = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Gastos', 'Ingresos', 'Balance'],
          datasets: [{
            label: 'Monto ($)',
            data: [totalGastos, totalIngresos, balance],
            backgroundColor: ['#f36ca7', '#36a2f7', '#34eb7a']
          }]
        },
        options: { 
          responsive: true,
          maintainAspectRatio: true,
          plugins: { 
            legend: { display: true },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return '$' + context.parsed.y.toLocaleString('es-CO');
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return '$' + value.toLocaleString('es-CO');
                }
              }
            }
          }
        }
      });
    }

    // Exportar Excel
    function exportExcel() {
      if(proveedores.length === 0 && gastos.length === 0 && ingresos.length === 0) {
        alert('‚ö†Ô∏è No hay datos para exportar');
        return;
      }
      
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(proveedores), "Proveedores");
      XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(gastos), "Gastos");
      XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(ingresos), "Ingresos");
      XLSX.writeFile(wb, "contabilidad_frutos_del_paraiso.xlsx");
      alert('‚úÖ Excel exportado correctamente');
    }

    // Cargar datos al iniciar
    mostrarProveedores();
    mostrarGastos();
    mostrarIngresos();
    actualizarResumen();
  </script>
</body>
</html>